Вопросы и проблемы по Up2date Windows client
============================================

Глобальные (productization)
---------------------------
* Определить юзкейсы включая взимодействие пользователя с Up2date клиентом
* Определить ограничения на поддерживаемые версии Windows (напр. XP, Embedded, Phone etc.)
* Выработать функциональные и дизайн требования к компонентам (напр. определиться с необходимостью "базы данных" по пакетам на клиентской стороне)
* Реализовать требуемую функциональность в сервисе и в консоли
* Хранение сертификата
* локализация, поддержка юникода (проблема в с++ библиотеке, как минимум)
* инсталляция клиента
* поддержка EXE пакетов от наиболее распространенных упаковщиков типа Inno Setup и т.п.(?)
* тестирование
	* модульные (unit) тесты
	* функциональные тесты
	* стресс тесты (напр. для выявления утечек памяти при долговременной работе сервиса/консоли)


Технические недоделки и баги
----------------------------

* Bug: при клике на тост запускается новый экз. консоли что приводит к попытке само-активации работающего, но попытка неуспешна
	* Клик на Тост всегда приводит к запуску нового экземпляра консоли
	* Клик на Тост "не доходит" до приложения и не перехватывается обработчиком
	Все это работает без проблем на тестовом проекте Dummy
* Проблемы инсталляции:
	* Консоль не останавливается автоматически при деинсталяции 
	* реализована инсталяция только для текущего пользователя 
	  (сервис работает независимо от того кто залогинен, но консоль/уведомления доступны только тому кто устанавливал клиента)
	* Не удаляется консоль при деинсталяции, даже если в ручную остановлена, что вызывает проблемы апгрейда

Замечания по сборке
-------------------
* Сборка:
	cd <path to Up2dateService folder e.g. "d:\repos\up2date-win\Up2dateService"> 
	msbuild.exe Up2dateService.sln /t:restore /p:RestorePackagesConfig=true
	devenv Up2dateService.sln /Rebuild "Release"

	Результат сборки:
	Setup32\Release\Setup.exe
	Setup32\Release\Up2dateSetup32.msi
	Setup64\Release\Setup.exe
	Setup64\Release\Up2dateSetup64.msi

Внимание!	
Если в процессе исполнения последней команды (devenv...) возникает ошибка
"An error occurred while validating. HRESULT = '8000000A'"
на сборочной платформе надо однократно запустить "workaround helper":
<path to Visual Studio at Program Files (x86)>\Common7\IDE\CommonExtensions\Microsoft\VSI\DisableOutOfProcBuild\DisableOutOfProcBuild.exe
(см. https://stackoverflow.com/questions/8648428/an-error-occurred-while-validating-hresult-8000000a)


* При сборке проекта Up2dateSetup нужно вручную корректно переключать разрядность в следующих местах:
	Properties -> TargetPlatform (x86/x64)
	right-click Up2dateSetup -> Properties -> Prerequisites -> Visual C++ "14" Runtime Libraries (x86/x64)
	right-click View -> Custom actions -> {each action} -> Properties -> Run64bit (False/True)

* Если возникают проблемы с Update Service Reference для консоли (небоходимо делать каждый раз при изменении контракта WCF сервиса):
  1) вместо Update Service Reference лучше удалить и пересоздать используя команду Add Service Reference
  2) при создании Service Reference снять галочку "Reuse types..." в Advanced
